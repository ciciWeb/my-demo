(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["create-order"],{"05f1":function(e,t,c){"use strict";c("d373")},"0eaf":function(e,t,c){"use strict";var a=c("7a8b");const r=e=>(Object(a["pushScopeId"])("data-v-81415816"),e=e(),Object(a["popScopeId"])(),e),o={class:"simple-header"},n={key:1},s={class:"simple-header-name"},d=r(()=>Object(a["createElementVNode"])("i",{class:"nbicon nbmore"},null,-1));function l(e,t,c,r,l,i){return Object(a["openBlock"])(),Object(a["createElementBlock"])("header",o,[r.isback?(Object(a["openBlock"])(),Object(a["createElementBlock"])("i",n,"      ")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("i",{key:0,class:"backicon",onClick:t[0]||(t[0]=(...e)=>r.goBack&&r.goBack(...e))})),Object(a["createElementVNode"])("div",s,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(c.name)+" ",1),Object(a["renderSlot"])(e.$slots,"name",{},void 0,!0)]),d])}var i=c("6a81"),b={props:{name:{type:String,default:""},back:{type:String,default:""},noback:{type:Boolean,default:!1}},emits:["callback"],setup(e,t){const c=Object(a["ref"])(e.noback),r=Object(i["d"])(),o=()=>{e.back?r.push({path:e.back}):r.go(-1),t.emit("callback")};return{goBack:o,isback:c}}},u=(c("2f24"),c("b3f2")),p=c.n(u);const O=p()(b,[["render",l],["__scopeId","data-v-81415816"]]);t["a"]=O},"2f24":function(e,t,c){"use strict";c("cf75")},"3f49":function(e,t,c){"use strict";c.d(t,"c",(function(){return r})),c.d(t,"b",(function(){return o})),c.d(t,"a",(function(){return n})),c.d(t,"f",(function(){return s})),c.d(t,"e",(function(){return d})),c.d(t,"d",(function(){return l}));var a=c("a27e");function r(e){return a["a"].post("/address",e)}function o(e){return a["a"].put("/address",e)}function n(e){return a["a"].delete("/address/"+e)}function s(){return a["a"].get("/address/default")}function d(){return a["a"].get("/address",{pageNumber:1,pageSize:1e3})}function l(e){return a["a"].get("/address/"+e)}},"4fa1":function(e,t,c){"use strict";c.r(t);var a=c("7a8b");const r=e=>(Object(a["pushScopeId"])("data-v-dd95502e"),e=e(),Object(a["popScopeId"])(),e),o={class:"create-order"},n={class:"address-wrap"},s={class:"address"},d={class:"good"},l={class:"good-img"},i=["src"],b={class:"good-desc"},u={class:"good-title"},p={class:"good-btn"},O={class:"price"},j={class:"pay-wrap"},m={class:"price"},f=r(()=>Object(a["createElementVNode"])("span",null,"商品金额",-1)),g=Object(a["createTextVNode"])("生成订单"),N={style:{width:"90%",margin:"0 auto",padding:"50px 0"}},k=Object(a["createTextVNode"])("支付宝支付"),y=Object(a["createTextVNode"])("微信支付");function h(e,t,c,r,h,v){const I=Object(a["resolveComponent"])("s-header"),V=Object(a["resolveComponent"])("van-icon"),E=Object(a["resolveComponent"])("van-button"),w=Object(a["resolveComponent"])("van-popup");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",o,[Object(a["createVNode"])(I,{name:"生成订单",onCallback:r.deleteLocal},null,8,["onCallback"]),Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",{class:"name",onClick:t[0]||(t[0]=(...e)=>r.goTo&&r.goTo(...e))},[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.address.userName),1),Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.address.userPhone),1)]),Object(a["createElementVNode"])("div",s,Object(a["toDisplayString"])(e.address.provinceName)+" "+Object(a["toDisplayString"])(e.address.cityName)+" "+Object(a["toDisplayString"])(e.address.regionName)+" "+Object(a["toDisplayString"])(e.address.detailAddress),1),Object(a["createVNode"])(V,{class:"arrow",name:"arrow"})]),Object(a["createElementVNode"])("div",d,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.cartList,(t,c)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:"good-item",key:c},[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("img",{src:e.$filters.prefix(t.goodsCoverImg),alt:""},null,8,i)]),Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(t.goodsName),1),Object(a["createElementVNode"])("span",null,"x"+Object(a["toDisplayString"])(t.goodsCount),1)]),Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",O,"¥"+Object(a["toDisplayString"])(t.sellingPrice),1)])])]))),128))]),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",m,[f,Object(a["createElementVNode"])("span",null,"¥"+Object(a["toDisplayString"])(r.total),1)]),Object(a["createVNode"])(E,{onClick:r.handleCreateOrder,class:"pay-btn",color:"#1baeae",type:"primary",block:""},{default:Object(a["withCtx"])(()=>[g]),_:1},8,["onClick"])]),Object(a["createVNode"])(w,{closeable:"","close-on-click-overlay":!1,show:e.showPay,"onUpdate:show":t[3]||(t[3]=t=>e.showPay=t),position:"bottom",style:{height:"30%"},onClose:r.close},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",N,[Object(a["createVNode"])(E,{style:{marginBottom:"10px"},color:"#1989fa",block:"",onClick:t[1]||(t[1]=e=>r.handlePayOrder(1))},{default:Object(a["withCtx"])(()=>[k]),_:1}),Object(a["createVNode"])(E,{color:"#4fc08d",block:"",onClick:t[2]||(t[2]=e=>r.handlePayOrder(2))},{default:Object(a["withCtx"])(()=>[y]),_:1})])]),_:1},8,["show","onClose"])])}c("6d73");var v=c("778e"),I=c("0eaf"),V=c("a27e");function E(e){return V["a"].get("/shop-cart/settle",{params:e})}var w=c("3f49"),C=c("99c5"),S=c("495f"),B=c("6a81"),x={components:{sHeader:I["a"]},setup(){const e=Object(B["d"])(),t=Object(B["c"])(),c=Object(a["reactive"])({cartList:[],address:{},showPay:!1,orderNo:"",cartItemIds:[]});Object(a["onMounted"])(()=>{r()});const r=async()=>{v["a"].loading({message:"加载中...",forbidClick:!0});const{addressId:a,cartItemIds:r}=t.query,o=r?JSON.parse(r):JSON.parse(Object(S["a"])("cartItemIds"));console.log("cartItemIds",r),Object(S["b"])("cartItemIds",JSON.stringify(o));const{data:n}=await E({cartItemIds:o.join(",")}),{data:s}=a?await Object(w["d"])(a):await Object(w["f"])();s?(c.cartList=n,c.address=s,v["a"].clear()):e.push({path:"/address"})},o=()=>{e.push({path:"/address",query:{cartItemIds:JSON.stringify(c.cartItemIds),from:"create-order"}})},n=()=>{Object(S["b"])("cartItemIds","")},s=async()=>{const e={addressId:c.address.addressId,cartItemIds:c.cartList.map(e=>e.cartItemId)},{data:t}=await Object(C["c"])(e);Object(S["b"])("cartItemIds",""),c.orderNo=t,c.showPay=!0},d=()=>{e.push({path:"/order"})},l=async t=>{await Object(C["e"])({orderNo:c.orderNo,payType:t}),v["a"].success("支付成功"),setTimeout(()=>{e.push({path:"/order"})},2e3)},i=Object(a["computed"])(()=>{let e=0;return c.cartList.forEach(t=>{e+=t.goodsCount*t.sellingPrice}),e});return{...Object(a["toRefs"])(c),goTo:o,deleteLocal:n,handleCreateOrder:s,close:d,handlePayOrder:l,total:i}}},D=(c("05f1"),c("b3f2")),P=c.n(D);const T=P()(x,[["render",h],["__scopeId","data-v-dd95502e"]]);t["default"]=T},"99c5":function(e,t,c){"use strict";c.d(t,"c",(function(){return r})),c.d(t,"d",(function(){return o})),c.d(t,"a",(function(){return n})),c.d(t,"b",(function(){return s})),c.d(t,"e",(function(){return d}));var a=c("a27e");function r(e){return a["a"].post("/saveOrder",e)}function o(e){return a["a"].get("/order/"+e)}function n(e){return a["a"].put(`/order/${e}/cancel`)}function s(e){return a["a"].put(`/order/${e}/finish`)}function d(e){return a["a"].get("/paySuccess",{params:e})}},cf75:function(e,t,c){},d373:function(e,t,c){}}]);
//# sourceMappingURL=create-order.7cb5529f.js.map